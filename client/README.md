```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—
 â–ˆâ–ˆâ•‘     â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—       â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•
 â–ˆâ–ˆâ•‘      â•šâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•       â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• 
 â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—       â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—  â•šâ–ˆâ–ˆâ•”â•  
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
 â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•       â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•â•  â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•   â•šâ•â•   
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        ğŸº CLIENT-SIDE SCRIPTS ğŸº
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

# ğŸ“ Client Directory

## ğŸ¯ Purpose

**Client-side scripts managing player interactions and user experience.**

This directory contains all client-facing code for the delivery job system, handling UI elements, player interactions with NPCs, wagon spawning and management, GPS routing, delivery completion detection, and client-side anti-exploit measures.

---

## ğŸ“„ File Descriptions

### `client.lua`
**Main client-side logic and delivery management**

- ğŸ® **Player Interface** - Menu systems for job selection
- ğŸš— **Wagon Management** - Spawns delivery vehicles with proper physics
- ğŸ—ºï¸ **GPS & Navigation** - Sets waypoints and manages delivery routes
- ğŸ“ **Proximity Detection** - Monitors distance to delivery zones
- âœ… **Completion Handling** - Detects successful deliveries
- ğŸ›¡ï¸ **Client-Side Protection** - Basic anti-exploit measures
- ğŸ¨ **Blip Management** - Creates and manages map markers

**Key Functions:**
- Delivery menu creation (ox_lib integration)
- Wagon spawning with network synchronization
- Delivery zone proximity checks
- Reward request communication with server
- Cleanup on job completion/cancellation

---

### `interaction.lua`
**NPC interaction and menu system handler**

- ğŸ‘¥ **NPC Interactions** - Manages player-NPC communication
- ğŸ¯ **Prompt System** - Native RedM prompts for interaction
- ğŸ”Œ **Murphy Integration** - Support for murphy_interact system
- â±ï¸ **Rate Limiting** - Anti-spam protection for interactions
- ğŸ“‹ **Menu Triggering** - Opens delivery selection interface
- ğŸ”’ **Cooldown Management** - Prevents interaction abuse

**Key Features:**
- Dual interaction method support (prompts/murphy)
- Client-side cooldown timers
- Smooth menu transitions
- Distance-based interaction zones

---

### `npcs.lua`
**NPC spawning and management**

- ğŸ§ **NPC Spawning** - Creates delivery job NPCs at configured locations
- ğŸ­ **Animations** - Sets NPC scenarios and idle animations
- ğŸš« **Entity Flags** - Makes NPCs invincible and non-targetable
- ğŸ—ºï¸ **Blip Creation** - Generates map markers for NPC locations
- ğŸ”„ **Lifecycle Management** - Handles NPC creation and cleanup
- âš™ï¸ **Config Integration** - Reads NPC data from shared config

**Responsibilities:**
- Spawn NPCs on resource start
- Apply correct models and animations
- Set entity properties (frozen, invincible)
- Create corresponding map blips
- Clean up on resource stop

---

## ğŸ”— How Client Connects to Server

### Event Communication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLIENT    â”‚                          â”‚   SERVER    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                         â”‚
       â”‚  lxr-delivery:server:startDelivery     â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚
       â”‚                                         â”‚
       â”‚                              Validates  â”‚
       â”‚                              Creates    â”‚
       â”‚                              Session    â”‚
       â”‚                                         â”‚
       â”‚  lxr-delivery:client:deliveryStarted   â”‚
       â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                                         â”‚
       â”‚  (Player delivers wagon)                â”‚
       â”‚                                         â”‚
       â”‚  lxr-delivery:server:completeDelivery  â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚
       â”‚                                         â”‚
       â”‚                              Validates  â”‚
       â”‚                              Calculates â”‚
       â”‚                              Gives $$$  â”‚
       â”‚                                         â”‚
       â”‚  lxr-delivery:client:rewardReceived    â”‚
       â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                                         â”‚
```

### Server Events Triggered by Client

- `lxr-delivery:server:startDelivery` - Request to start a delivery job
- `lxr-delivery:server:completeDelivery` - Notify server of delivery completion
- `lxr-delivery:server:cancelDelivery` - Cancel active delivery

### Client Events Received from Server

- `lxr-delivery:client:deliveryStarted` - Confirmation job started
- `lxr-delivery:client:rewardReceived` - Delivery complete, reward given
- `lxr-delivery:client:notifyError` - Error messages from server

---

## ğŸ›¡ï¸ Client-Side Security

### Anti-Exploit Measures

1. **Rate Limiting** - Cooldowns on interactions prevent spam
2. **Session Checks** - Validates active delivery state
3. **Distance Validation** - Ensures proper proximity to zones
4. **Cooldown Timers** - Prevents rapid job completion
5. **Input Sanitization** - Validates menu selections

> **Note:** Primary security validation occurs server-side. Client measures provide UX improvements and basic filtering.

---

## âš¡ Performance Considerations

- **Threaded Loops** - Efficient proximity detection
- **Event-Driven** - Minimal constant processing
- **Optimized Natives** - Carefully selected game functions
- **Resource Cleanup** - Proper entity and blip deletion
- **Conditional Processing** - Only active when needed

**Target:** 60+ FPS maintained during all operations

---

## ğŸ”§ Configuration

Client scripts read from `shared/config.lua`:

- **Interaction Method** - `Config.UsePrompt` vs Murphy
- **NPC Locations** - Spawn points and coordinates
- **Delivery Destinations** - Available target locations
- **Blip Settings** - Sprites, colors, labels
- **Cooldown Timers** - Anti-spam delays

---

## ğŸ§ª Testing Client Scripts

### Manual Testing Checklist

- [ ] Approach NPC - prompt appears
- [ ] Open delivery menu - locations display
- [ ] Select destination - wagon spawns
- [ ] GPS waypoint - correctly set
- [ ] Deliver wagon - completion detected
- [ ] Receive reward - notification shown
- [ ] Cancel job - proper cleanup
- [ ] Spam protection - cooldowns working

---

## ğŸ“ Support

**Issues with client scripts?**

- Check browser console (F8) for Lua errors
- Verify ox_lib is installed and running
- Confirm framework is correctly set in config
- Test with minimal resource load
- Report bugs: [GitHub Issues](https://github.com/iBoss21/lxr-deliveryjob/issues)

---

**ğŸº The Land of Wolves | Client-Side Excellence**  
*Optimized for Performance, Built for Roleplay*

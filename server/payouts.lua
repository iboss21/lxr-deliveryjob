local function repMul(src) local rep=exports['lxr-delivery-supreme']:getRep(src) or 0 return Config.Reputation.curve(rep) end
function ComputePayout(src,baseReward,data) local mult=1.0 if data and data.risk and Config.RiskMultipliers[data.risk] then mult=mult*Config.RiskMultipliers[data.risk] end local label=(data and (data.label or data.id)) or 'unknown'; local dm=exports['lxr-delivery-supreme']:demandFor(label) or 1.0; mult=mult*dm if data and data.stealth then if State.stealth[src]==true then mult=mult*1.15 else mult=mult*0.85 end end if Config.CoOp.enabled then local count=#GetPlayers(); local bonus=math.min(Config.CoOp.maxBonus,(math.max(0,count-1)*Config.CoOp.posseBonusPerMember)); mult=mult*(1.0+bonus) end local dmg=clamp((State.damage[src] or 0.0),0.0,1.0); local pen=Config.DevGodMode and 1.0 or Config.DamagePenaltyCurve(dmg); mult=mult*pen; mult=mult*repMul(src); return math.floor((baseReward or 0)*mult),dmg end

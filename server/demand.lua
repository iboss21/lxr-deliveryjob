CreateThread(function() while true do if Config.DynamicDemand.enabled then for bi,b in ipairs(Config.Boards) do for _,d in ipairs(b.deliveries or {}) do local k=d.label or d.id or ('dest_'..bi); State.demand[k]=State.demand[k] or (Config.DynamicDemand.floor+(Config.DynamicDemand.ceil-Config.DynamicDemand.floor)*math.random()); local dir=(math.random()<0.5) and -1 or 1; local step=Config.DynamicDemand.volatility*0.05; State.demand[k]=clamp(State.demand[k]+dir*step,Config.DynamicDemand.floor,Config.DynamicDemand.ceil) end end end Wait(60*1000*(Config.DynamicDemand.updateEveryMin or 40)) end end)
exports('demandFor',function(label) return (State.demand[label or ''] or 1.0) end)

exports('awardXP',function(src,amt) local id=Framework.identifier(src);local lvl,xp,rep=Storage.get(id);local gain=amt or Config.Progression.xp.success;local new=xp+gain;local nextL=lvl;for i=1,#Config.Progression.levels do if new>=Config.Progression.levels[i] then nextL=i end end;Storage.set(id,nextL,new,rep);if nextL>lvl then TriggerClientEvent('lxr:supreme:perkUnlock',src,nextL,Config.Progression.perks[nextL] or {}) Logger.levelup(src,('Tier %d unlocked'):format(nextL)) end return nextL,new end)
exports('repChange',function(src,delta) local id=Framework.identifier(src);local lvl,xp,rep=Storage.get(id);rep=clamp(rep+delta,Config.Reputation.min,Config.Reputation.max);Storage.set(id,lvl,xp,rep);Logger.rep(src,('Rep %+d -> %d'):format(delta,rep));return rep end)
